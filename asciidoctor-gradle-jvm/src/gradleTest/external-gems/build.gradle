plugins {
    id 'org.asciidoctor.jvm.convert'
    id 'com.github.jruby-gradle.base' version '1.5.0'
}

dependencies {
    gems 'rubygems:asciidoctor-bibtex:0.3.1'
}

asciidoctorj {

    requires 'asciidoctor-bibtex'
    gemPaths jrubyPrepare.outputDir
}

asciidoctor {
    dependsOn jrubyPrepare

    secondarySources {
        include 'biblio.bib'
    }

    attributes 'bibtex-file' : file("${sourceDir}/biblio.bib")
}

task runGradleTest {
    dependsOn asciidoctor
}